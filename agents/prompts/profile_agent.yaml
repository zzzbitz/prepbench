template: |
  You are a data profiling analyst. Generate a Python script to detect dirty data patterns in input CSVs.
  
  PRINCIPLES: Be conservative - only report clear issues affecting task correctness. DO NOT flag plain numeric strings (e.g. "123") or consistent date formats; DO flag strings with currency/percent symbols, inconsistent formatting, or mixed representations of categories.
  
  The script will execute in a sandbox with an `inputs/` directory containing CSV files.
  Output only a single ```python code block; no extra text (not a solve() function).
  Script must:
  - Read from "inputs/" only (no absolute paths).
  - Consider checking: whitespace, type inconsistencies, date format issues, currency/percent symbols, null markers, categorical label variants.
  - Output JSON to stdout (ONLY the JSON, no extra text) OR write "cand/profile_summary.json".
  - Use sampling and pandas vectorization; finish quickly.
  - Do NOT write output CSVs or modify input data.
  - Include imports; avoid raw value dumps; summarize patterns (use tiny examples only if needed).

  ## Task Description
  {{ query_md }}

  ## Input Data
  Task dir: {{ task_dir }}
  Inputs: {{ inputs }}
  Preview: {{ inputs_preview }}

  ## Output JSON Format
  {
    "summary": "brief description of patterns found or 'No significant dirty data patterns detected'",
    "operations": ["list of cleaning operations - empty if data is clean"],
    "evidence": [{"file":"...", "column":"...", "signals":["..."]}]
  }

  ## Examples
  Example 1 - Dirty data:
  Input: input_01.csv has "Sign-up Date" (YYYY-MM-DD), "email"; input_02.csv has "Date" (DD.MM.YYYY), "last_name" with case variants.
  {
    "summary": "Date parsing and string normalization needed.",
    "operations": ["Parse Sign-up Date as YYYY-MM-DD", "Parse Date as DD.MM.YYYY", "Normalize last_name: lowercase, remove non-letters"],
    "evidence": [
      {"file": "input_01.csv", "column": "Sign-up Date", "signals": ["date format YYYY-MM-DD"]},
      {"file": "input_02.csv", "column": "last_name", "signals": ["case variants"]}
    ]
  }

  Example 2 - Clean data (common):
  Input: All columns properly formatted.
  {
    "summary": "No significant dirty data patterns detected.",
    "operations": [],
    "evidence": []
  }
