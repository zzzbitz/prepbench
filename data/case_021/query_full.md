## Context
You are continuing the hospital-cost tracking workflow from the prior week. New patient records have arrived in a CSV file (with a different patient-name column header than before), and there is also a separate dataset defining the frequency and length of post-discharge check-ups. The objective is to refresh the Week 20 outputs to include both the newly arrived patients and the additional hospital days generated by scheduled check-up visits, using the same daily cost model as before.

## Requirements
- Input the data:
  - Read the new patient file (`input_01.csv`) containing patient name, first-visit date, and length of stay.
  - Read the prior patient file (`input_02.csv`) containing the same concepts, but with the patient name field labeled `Name` (rename it to `Patient Name` to align).
  - Read the check-up schedule file (`input_03.csv`) containing:
    - `Months After Leaving` (an integer number of calendar months after discharge when a check-up starts)
    - `Length of Stay` (number of days for that check-up visit).
- Add new Patient Data:
  - Combine (append) the old and new patient datasets into a single patient list after aligning columns to at least: `Patient Name`, `First Visit`, `Length of Stay`.
  - Parse `First Visit` dates using the appropriate formats so they become true dates:
    - New patients: day/month/year.
    - Old patients: year-month-day.
  - Cast `Length of Stay` to an integer number of days.
- Generate daily hospital records for each patient’s initial stay:
  - Define one “daily hospital record” as one patient occupying a hospital bed on one calendar date.
  - For each patient’s initial stay, expand the record into `Length of Stay` daily rows.
  - Create a 1-based `DayIndex` within each initial stay (1 for the first day of that stay, 2 for the second day, etc.).
  - Compute `Date in Hospital` for each expanded row as:  
    `First Visit + (DayIndex - 1) days`.
  - Apply the daily cost model based on `DayIndex` within the stay:
    - DayIndex 1–3: cost = 100
    - DayIndex 4–7: cost = 80
    - DayIndex 8 and above: cost = 75
- Add Frequency of Check-Ups data and generate additional hospital records:
  - Compute each patient’s `Leave Date` for the initial stay as:  
    `First Visit + (Length of Stay - 1) days`  
    (i.e., the last date included in their initial stay).
  - For each patient, create check-up visits by pairing that patient with every row in the check-up schedule (i.e., apply the schedule to all patients).
  - For each patient–schedule pair, compute the check-up start date (“check-in date”) as a calendar-month offset from the patient’s `Leave Date`:  
    `Checkin Date = Leave Date + Months After Leaving (in calendar months)`.
  - Treat each check-up as a new entry into hospital:
    - Expand each check-up visit into `Length of Stay` daily rows.
    - Create a new 1-based `DayIndex` within each check-up stay (grouped by `Patient Name` and `Checkin Date`), and compute `Date in Hospital` as:  
      `Checkin Date + (DayIndex - 1) days`.
    - Apply the same daily cost model based on `DayIndex` within that check-up stay, meaning check-up day one is always costed as day 1 (100), regardless of the patient’s previous stays.
- Refresh the Data Outputs from Week 20 by using the combined daily records from:
  - all initial-stay daily rows, and
  - all check-up daily rows.
- Output calculations:
  - Output 1 (daily aggregation):
    - Group by `Date in Hospital`.
    - `Total Cost per Day` = sum of daily `Cost` across all patient-rows on that date.
    - `Number of Patients` = count of distinct `Patient Name` values on that date.
    - `Avg Cost per Day` = `Total Cost per Day / Number of Patients`, rounded to 2 decimal places.
    - Format `Date in Hospital` as `dd/mm/YYYY` when writing the file.
  - Output 2 (patient aggregation):
    - Group by `Patient Name`.
    - `Total Cost per Day` = sum of daily `Cost` across all days for that patient (initial stays plus check-ups).
    - Compute `Days` as the count of daily rows for that patient.
    - `Avg Cost per Day` = `Total Cost per Day / Days`, rounded to 2 decimal places using round-half-up logic.
- Output the data exactly as specified below.

## Output

- output_01.csv
  - 4 fields:
    - Avg Cost per Day
    - Total Cost per Day
    - Date in Hospital
    - Number of Patients

- output_02.csv
  - 3 fields:
    - Avg Cost per Day
    - Total Cost per Day
    - Patient Name