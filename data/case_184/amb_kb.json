{
  "ambiguities": [
    {
      "id": "1_D2_join_key_product",
      "kind": "Multi-table alignment",
      "node_id": "join_prod",
      "op": "join",
      "source_text": "Link in the product Lookup to name the products instead of having their ID number",
      "ref": "combined = combined.merge(product_lookup, on=\"Product\", how=\"left\")"
    },
    {
      "id": "2_O2_join_how_left",
      "kind": "Operation incomplete",
      "node_id": "join_prod",
      "op": "join",
      "source_text": "Link in the product Lookup to name the products instead of having their ID number",
      "ref": "how=\"left\""
    },
    {
      "id": "3_D1_online_timestamp_rename",
      "kind": "Single-table reference",
      "node_id": "online_std",
      "op": "project",
      "source_text": "Link the Instore and Online sales together to be one data source",
      "ref": "online_sales = online_sales.rename(columns={\"Sales Timestamp\": \"Sales Date\"})"
    },
    {
      "id": "4_O2_datetime_parse",
      "kind": "Operation boundary",
      "node_id": "prep_sales",
      "op": "project",
      "source_text": "Workout how long it took between the original sale and the next sale in minutes",
      "ref": "combined[\"Sales Date\"] = pd.to_datetime(combined[\"Sales Date\"], format=\"%d/%m/%Y %H:%M:%S\")"
    },
    {
      "id": "5_O2_product_type_from_first_word",
      "kind": "Row-level concept",
      "node_id": "prep_sales",
      "op": "project",
      "source_text": "Create the 'Product Type' field by taking the first word of the product name",
      "ref": "combined[\"Product Type\"] = combined[\"Product Name\"].str.split().str[0]"
    },
    {
      "id": "7_O2_drop_rows_without_next_sale",
      "kind": "Operation incomplete",
      "node_id": "valid_rows",
      "op": "filter",
      "source_text": "includes the next sale after the one made in the SAME store of the same product type",
      "ref": "combined2 = combined2[combined2[\"Time Diff Minutes\"].notna()]"
    }
  ]
}