{
  "ambiguities": [
    {
      "id": "1_d2_account_createdbyid_to_userid",
      "kind": "Multi-table alignment",
      "node_id": "acct_join_created",
      "op": "join",
      "intent": "Map Account CreatedById to User.Id to derive Account Created By Name.",
      "ref": "acct[\"Account Created By Name\"] = acct[\"Account CreatedById\"].map(name_map)"
    },
    {
      "id": "2_o2_account_createdby_no_match_null",
      "kind": "Operation incomplete",
      "node_id": "acct_join_created",
      "op": "join",
      "intent": "If CreatedById has no matching User.Id, leave Created By Name as null.",
      "ref": ".map(name_map)"
    },
    {
      "id": "3_d2_account_ownerid_to_userid",
      "kind": "Multi-table alignment",
      "node_id": "acct_join_owner",
      "op": "join",
      "intent": "Map Account OwnerId to User.Id to derive Account Owner Name.",
      "ref": "acct[\"Account Owner Name\"] = acct[\"Account OwnerId\"].map(name_map)"
    },
    {
      "id": "4_o2_account_owner_no_match_null",
      "kind": "Operation incomplete",
      "node_id": "acct_join_owner",
      "op": "join",
      "intent": "If OwnerId has no matching User.Id, leave Owner Name as null.",
      "ref": ".map(name_map)"
    },
    {
      "id": "5_c2_account_num_opps_distinct_count",
      "kind": "Group-level concept",
      "node_id": "acct_name_aggs",
      "op": "aggregate",
      "source_text": "Which Account has the most Opportunities & Amount?",
      "ref": "\"Number of Opportunities\": (\"Opportunity ID\", pd.Series.nunique)"
    },
    {
      "id": "6_c2_account_amount_sum",
      "kind": "Group-level concept",
      "node_id": "acct_name_aggs",
      "op": "aggregate",
      "source_text": "Which Account has the most Amount?",
      "ref": "\"Amount\": (\"Amount\", \"sum\")"
    },
    {
      "id": "7_o2_null_group_included_in_aggregation",
      "kind": "Operation boundary",
      "node_id": "aggs",
      "op": "aggregate",
      "intent": "Include rows with null values as their own group in aggregations.",
      "ref": "groupby(..., dropna=False)"
    },
    {
      "id": "8_d2_opportunity_createdbyid_to_userid",
      "kind": "Multi-table alignment",
      "node_id": "opp_join_created",
      "op": "join",
      "intent": "Map Opportunity CreatedById to User.Id to derive Created By Name.",
      "ref": "opp[\"Created By Name\"] = opp[\"CreatedById\"].map(name_map)"
    },
    {
      "id": "9_o2_opportunity_createdby_no_match_null",
      "kind": "Operation incomplete",
      "node_id": "opp_join_created",
      "op": "join",
      "intent": "If CreatedById has no matching User.Id, leave Created By Name as null.",
      "ref": ".map(name_map)"
    },
    {
      "id": "10_d2_opportunity_ownerid_to_userid",
      "kind": "Multi-table alignment",
      "node_id": "opp_join_owner",
      "op": "join",
      "intent": "Map Opportunity OwnerId to User.Id to derive Owner Name.",
      "ref": "opp[\"Owner Name\"] = opp[\"OwnerId\"].map(name_map)"
    },
    {
      "id": "11_o2_opportunity_owner_no_match_null",
      "kind": "Operation incomplete",
      "node_id": "opp_join_owner",
      "op": "join",
      "intent": "If OwnerId has no matching User.Id, leave Owner Name as null.",
      "ref": ".map(name_map)"
    },
    {
      "id": "12_d2_opportunity_accountid_to_accountid",
      "kind": "Multi-table alignment",
      "node_id": "opp_with_account",
      "op": "join",
      "intent": "Join Opportunities to Accounts on AccountId = Account Id.",
      "ref": "left_on=\"AccountId\", right_on=\"Account Id\""
    },
    {
      "id": "13_o2_opportunity_keep_unmatched_accounts",
      "kind": "Operation incomplete",
      "node_id": "opp_with_account",
      "op": "join",
      "intent": "Keep all Opportunity rows even when no matching Account.",
      "ref": "how=\"left\""
    },
    {
      "id": "14_c2_owner_amount_sum",
      "kind": "Group-level concept",
      "node_id": "owner_sum",
      "op": "aggregate",
      "source_text": "Who is the Owner with the Highest Amount?",
      "ref": "[\"Amount\"].sum()"
    }
  ]
}
