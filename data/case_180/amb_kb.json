{
  "ambiguities": [
    {
      "id": "1_C2_region_aggregation",
      "kind": "Group-level concept",
      "node_id": "agg_region",
      "op": "aggregate",
      "source_text": "Create a Region Sales Table which calculates the Sale Value for each Store, Product and Day",
      "ref": "grouped = sales.groupby(['Store', 'Product', 'Date'], as_index=False)['Sale Value'].sum()"
    },
    {
      "id": "2_D2_targets_key_casing_title",
      "kind": "Single-table reference",
      "node_id": "clean_targets_step2",
      "op": "project",
      "source_text": "Prepare your data sets for joining together by choosing your next step",
      "ref": "Standardize casing (title case) for Store and Product before join"
    },
    {
      "id": "3_C2_beats_target_ge",
      "kind": "Row-level concept",
      "node_id": "derive_beats",
      "op": "project",
      "source_text": "Calculate whether each product in each store beats the target",
      "ref": "Beats Target = Sale Value >= Target"
    },
    {
      "id": "4_O2_missing_target_false",
      "kind": "Operation incomplete",
      "node_id": "derive_beats",
      "op": "project",
      "intent": "If no target exists for a store-product combination, Beats Target = False.",
      "ref": "fillna(False)"
    },
    {
      "id": "5_C1_product_type_delimiter_split",
      "kind": "Row-level concept",
      "node_id": "derive_product_type",
      "op": "project",
      "source_text": "Remove unnecessary values from the Product Name field to just leave the Product Type",
      "ref": "Product Type = split on ' - ', take first part"
    },
    {
      "id": "6_O2_join_left_keep_sales",
      "kind": "Operation incomplete",
      "node_id": "join_sales_targets",
      "op": "join",
      "source_text": "Join the Region Sales Table to the Targets table",
      "ref": "merged = sales.merge(targets, on=['Store', 'Product'], how='left')"
    },
    {
      "id": "7_D1_targets_wide_to_long_mapping",
      "kind": "Single-table reference",
      "node_id": "targets_long",
      "op": "pivot",
      "source_text": "Change the Targets data set into three columns",
      "ref": "Unpivot store columns to rows"
    }
  ]
}