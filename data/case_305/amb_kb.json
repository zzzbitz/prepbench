{
  "ambiguities": [
    {
      "id": "1_C2_percent_change_formula",
      "kind": "Group-level concept",
      "node_id": "compute_change",
      "op": "project",
      "source_text": "Find the Percentage difference between their Avg Judge's Score for the first dance and the average Avg Judge's Score in the final",
      "ref": "% Change = (Final_Avg - First_Avg) / First_Avg"
    },
    {
      "id": "2_O2_repeated_header_detection",
      "kind": "Operation incomplete",
      "node_id": "filter_headers",
      "op": "filter",
      "intent": "Drop rows that appear to be repeated headers (where column values match header names).",
      "ref": "df = df[df['Week'] != 'Week']"
    },
    {
      "id": "3_O2_drop_uncomputable_avg_judge_score",
      "kind": "Operation incomplete",
      "node_id": "filter_valid",
      "op": "filter",
      "intent": "Drop rows where Avg Judge's Score cannot be computed.",
      "ref": "df = df.dropna(subset=['Avg Judge\\'s Score'])"
    },
    {
      "id": "4_C1_finalist_position_from_result_keywords",
      "kind": "Row-level concept",
      "node_id": "final_post",
      "op": "project",
      "source_text": "Result (win, runner-up, third place)",
      "ref": "'winner'->Winners, 'runner'->Runners-up, 'third'->Third place"
    },
    {
      "id": "5_C2_final_avg_weighted_by_judge_count",
      "kind": "Group-level concept",
      "node_id": "final_post",
      "op": "project",
      "source_text": "For couples who danced multiple times in the final, calculate the average of their Avg Judge's Score",
      "ref": "Final_Avg = sum(Total_Score) / sum(Num_Judges)"
    },
    {
      "id": "6_O3_first_dance_same_week_aggregation",
      "kind": "Group-level concept",
      "node_id": "first_dance",
      "op": "aggregate",
      "source_text": "their first dance",
      "ref": "If multiple dances in first week, average their scores"
    },
    {
      "id": "7_C1_first_dance_is_min_numeric_week",
      "kind": "Row-level concept",
      "node_id": "first_dance",
      "op": "project",
      "source_text": "their first dance",
      "ref": "First dance = dance in minimum numeric Week"
    },
    {
      "id": "8_O2_keep_only_couples_with_finalist_position",
      "kind": "Row-level concept",
      "node_id": "output_filter",
      "op": "filter",
      "source_text": "only three couples will be included in this output",
      "ref": "Keep only couples who have a Result (Winners/Runners-up/Third)"
    },
    {
      "id": "9_C1_final_week_text_matching_rule",
      "kind": "Row-level concept",
      "node_id": "parse_fields",
      "op": "project",
      "source_text": "their dances in the final",
      "ref": "Match 'final' but not 'semi-final' or 'quarter-final'"
    },
    {
      "id": "10_O2_week_number_extraction_pattern",
      "kind": "Single-table reference",
      "node_id": "parse_week",
      "op": "project",
      "source_text": "Identify the week number",
      "ref": "Extract numeric week from Week column"
    }
  ]
}