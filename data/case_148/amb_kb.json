{
  "ambiguities": [
    {
      "id": "1_employment_range_min_max",
      "kind": "Group-level concept",
      "node_id": "n_agg_range",
      "op": "aggregate",
      "source_text": "Create the Employment Range field which captures the employees full tenure at the company",
      "ref": "employment_range = df.groupby('Name')['Date'].agg(['min', 'max']).reset_index()"
    },
    {
      "id": "2_months_worked_row_count",
      "kind": "Group-level concept",
      "node_id": "n_agg_yearly",
      "op": "aggregate",
      "source_text": "Number of months they worked",
      "ref": "months_worked=('Date', 'count'),"
    },
    {
      "id": "3_annual_salary_first_value",
      "kind": "Operation inconsistent",
      "node_id": "n_agg_yearly",
      "op": "aggregate",
      "source_text": "Their salary they will have received",
      "ref": "annual_salary=('Annual Salary', 'first'), # Salary can change year to year"
    },
    {
      "id": "4_join_employment_range_on_name",
      "kind": "Multi-table alignment",
      "node_id": "n_join_range",
      "op": "join",
      "intent": "Attach Employment Range back to each row by joining on Name.",
      "ref": "df = pd.merge(df, employment_range[['Name', 'Employment Range']], on='Name')"
    },
    {
      "id": "5_salary_paid_proration_months",
      "kind": "Group-level concept",
      "node_id": "n_project_calc",
      "op": "project",
      "source_text": "Their salary they will have received",
      "ref": "yearly_summary['Salary Paid'] = round((yearly_summary['annual_salary'] / 12) * yearly_summary['months_worked'], 2)"
    },
    {
      "id": "6_reporting_year_from_date_year",
      "kind": "Row-level concept",
      "node_id": "n_project_parse",
      "op": "project",
      "intent": "Derive Reporting Year as the calendar year extracted from Date.",
      "ref": "df['Reporting Year'] = df['Date'].dt.year"
    },
    {
      "id": "7_date_parse_dayfirst",
      "kind": "Operation boundary",
      "node_id": "n_project_parse",
      "op": "project",
      "intent": "Interpret Date as a day-first calendar date when parsing to datetime.",
      "ref": "df = pd.read_csv(inputs_dir / \"input_01.csv\", parse_dates=['Date'], dayfirst=True)"
    }
  ]
}