{
  "ambiguities": [
    {
      "id": "1_C2_expected_goals_formula_per_match",
      "kind": "Group-level concept",
      "node_id": "compute_expected",
      "op": "project",
      "source_text": "Calculate the Expected number of Goals for each Segment, Competition and Decade",
      "ref": "Expected Goals = Total Goals / Matches in Decade per Competition"
    },
    {
      "id": "2_O2_expected_goals_divide_by_zero_default",
      "kind": "Operation boundary",
      "node_id": "compute_expected",
      "op": "project",
      "intent": "If match count is zero, Expected Goals = 0 or null.",
      "ref": "fillna(0)"
    },
    {
      "id": "3_O2_drop_goals_with_unusable_minute_for_segment",
      "kind": "Operation incomplete",
      "node_id": "filter_goals",
      "op": "filter",
      "intent": "Drop goals where the minute cannot be parsed for segment assignment.",
      "ref": "df = df.dropna(subset=['Minute'])"
    },
    {
      "id": "4_O1_segment_bin_boundaries",
      "kind": "Operation boundary",
      "node_id": "goals_with_segment",
      "op": "project",
      "source_text": "Join on the Segment table based on what segment of time the goal was scored in",
      "ref": "0-15: <15, 15-30: 15<=x<30, ..., 90+: >=90"
    },
    {
      "id": "5_D2_join_goals_to_results",
      "kind": "Multi-table alignment",
      "node_id": "joined_goals_results",
      "op": "join",
      "source_text": "Filter out the nulls from the Goal Scorers table and join to the dataset",
      "ref": "Join on date + home_team + away_team"
    },
    {
      "id": "6_C2_match_count_distinctness_by_match_id",
      "kind": "Group-level concept",
      "node_id": "match_counts",
      "op": "aggregate",
      "source_text": "Calculate the Expected number of Goals for each Segment, Competition and Decade",
      "ref": "Match count = nunique(Match ID)"
    },
    {
      "id": "7_O2_exclude_non_fifa_competitions",
      "kind": "Row-level concept",
      "node_id": "results_filter",
      "op": "filter",
      "intent": "Exclude results where tournament is not in the reference list of FIFA competitions.",
      "ref": "df = df[df['tournament'].isin(fifa_competitions)]"
    },
    {
      "id": "8_C1_concacaf_championship_mapped_to_gold_cup",
      "kind": "Row-level concept",
      "node_id": "results_with_competition",
      "op": "project",
      "source_text": "ensure correct Football Association and Competition for CONCACAF Championship",
      "ref": "CONCACAF Championship -> Gold Cup"
    },
    {
      "id": "9_C2_decade_computation",
      "kind": "Row-level concept",
      "node_id": "results_with_decade",
      "op": "project",
      "source_text": "Create a field to categorise each Result by their Decade",
      "ref": "Decade = year // 10 * 10"
    },
    {
      "id": "10_C2_match_id_construction_format",
      "kind": "Row-level concept",
      "node_id": "results_with_match_id",
      "op": "project",
      "source_text": "Create a Match ID field so every row in the data has a unique identifier",
      "ref": "Match ID = date|home_team|away_team"
    }
  ]
}