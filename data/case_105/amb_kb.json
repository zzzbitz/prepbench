{
  "ambiguities": [
    {
      "id": "1_C2_avg_money_per_event_definition",
      "kind": "Group-level concept",
      "node_id": "agg_by_tour",
      "op": "aggregate",
      "source_text": "How much do players win per event? What's the average of this for each tour?",
      "ref": "df['money_per_event'] = df['MONEY'] / df['EVENTS']\navg_money_per_event = (\n        df.groupby('TOUR', as_index=False)[\n            'money_per_event'].mean().set_index('TOUR')['money_per_event']\n    )"
    },
    {
      "id": "2_C2_diff_lpga_minus_pga_int_measures",
      "kind": "Row-level concept",
      "node_id": "post_int",
      "op": "project",
      "source_text": "difference between the LPGA from the PGA",
      "ref": "def make_row(measure: str, pga_val, lpga_val):\n        return {\n            'Measure': measure,\n            'PGA': pga_val,\n            'LPGA': lpga_val,\n            'Difference between tours': lpga_val - pga_val,\n        }"
    },
    {
      "id": "3_O1_diff_int_cast",
      "kind": "Operation boundary",
      "node_id": "post_int",
      "op": "project",
      "intent": "For the integer-valued measures, output the “Difference between tours” as an integer (not a float).",
      "ref": "row_num_players = make_row(\n        'Number of Players',\n        int(num_players.get('PGA', 0)),\n        int(num_players.get('LPGA', 0)),\n    )"
    },
    {
      "id": "4_C2_diff_lpga_minus_pga_rank",
      "kind": "Row-level concept",
      "node_id": "post_rank",
      "op": "project",
      "source_text": "difference between the LPGA from the PGA",
      "ref": "diff_rank = round(lpga_rank - pga_rank, 2)"
    },
    {
      "id": "5_O1_rank_diff_round_2dp",
      "kind": "Operation boundary",
      "node_id": "post_rank",
      "op": "project",
      "intent": "Round the “Difference between tours” for Avg Difference in Ranking to 2 decimal places.",
      "ref": "diff_rank = round(lpga_rank - pga_rank, 2)\nrow_avg_rank_diff = {\n        'Measure': 'Avg Difference in Ranking',\n        'PGA': pga_rank,\n        'LPGA': lpga_rank,\n        'Difference between tours': float(f\"{diff_rank:.2f}\")\n    }"
    },
    {
      "id": "6_O1_avg_mpe_round_0dp_int",
      "kind": "Operation boundary",
      "node_id": "proj_avg_mpe",
      "op": "project",
      "intent": "Round Avg Money per Event to 0 decimals and output it as an integer.",
      "ref": "row_avg_money_per_event = make_row(\n        'Avg Money per Event',\n        int(round(float(avg_money_per_event.get('PGA', 0.0)), 0)),\n        int(round(float(avg_money_per_event.get('LPGA', 0.0)), 0)),\n    )"
    },
    {
      "id": "7_C2_dense_ranking_by_money_desc",
      "kind": "Group-level concept",
      "node_id": "proj_clean",
      "op": "project",
      "source_text": "How do players rank by prize money for each tour? What about overall?",
      "ref": "df['tour_rank'] = df.groupby('TOUR')['MONEY'].rank(\n        method='dense', ascending=False)\ndf['overall_rank'] = df['MONEY'].rank(method='dense', ascending=False)"
    },
    {
      "id": "8_C2_rank_diff_overall_minus_tour",
      "kind": "Row-level concept",
      "node_id": "proj_clean",
      "op": "project",
      "source_text": "average difference between where they are ranked within their tour compared to the overall rankings",
      "ref": "df['rank_diff'] = df['overall_rank'] - df['tour_rank']"
    },
    {
      "id": "9_O1_total_events_integer",
      "kind": "Operation boundary",
      "node_id": "proj_num_events",
      "op": "project",
      "intent": "Output Number of Events as an integer.",
      "ref": "row_num_events = make_row(\n        'Number of Events',\n        int(total_events.get('PGA', 0)),\n        int(total_events.get('LPGA', 0)),\n    )"
    },
    {
      "id": "10_O1_num_players_integer",
      "kind": "Operation boundary",
      "node_id": "proj_num_players",
      "op": "project",
      "intent": "Output Number of Players as an integer.",
      "ref": "row_num_players = make_row(\n        'Number of Players',\n        int(num_players.get('PGA', 0)),\n        int(num_players.get('LPGA', 0)),\n    )"
    },
    {
      "id": "11_O1_avg_rank_diff_round_2dp",
      "kind": "Operation boundary",
      "node_id": "proj_rank_long",
      "op": "project",
      "intent": "Round Avg Difference in Ranking tour values to 2 decimal places.",
      "ref": "pga_rank = round(float(avg_rank_diff.get('PGA', 0.0)), 2)\nlpga_rank = round(float(avg_rank_diff.get('LPGA', 0.0)), 2)"
    },
    {
      "id": "12_O1_total_prize_integer",
      "kind": "Operation boundary",
      "node_id": "proj_total_money",
      "op": "project",
      "intent": "Output Total Prize Money as an integer.",
      "ref": "row_total_money = make_row(\n        'Total Prize Money',\n        int(total_prize.get('PGA', 0)),\n        int(total_prize.get('LPGA', 0)),\n    )"
    }
  ]
}