{
  "ambiguities": [
    {
      "id": "1_O2_publish_ts_parse_format",
      "kind": "Operation boundary",
      "node_id": "parse_publish",
      "op": "project",
      "source_text": "Find the time between when a vehicle is first advertised on the site to when the vehicle was sold",
      "ref": "pd.to_datetime(df['first_published'])"
    },
    {
      "id": "2_O2_sold_definition_sale_date_present",
      "kind": "Row-level concept",
      "node_id": "filter_sold",
      "op": "filter",
      "source_text": "Find the time between when a vehicle is first advertised on the site to when the vehicle was sold",
      "ref": "A vehicle is sold if sale_date is not null"
    },
    {
      "id": "3_O1_round_dealership_avg_up",
      "kind": "Operation boundary",
      "node_id": "ceil_avg",
      "op": "project",
      "source_text": "group up to the nearest whole day",
      "ref": "Dealership Avg Days = ceil(avg(Days to Sell))"
    },
    {
      "id": "4_C2_days_to_sell_ceiling",
      "kind": "Operation boundary",
      "node_id": "compute_days",
      "op": "project",
      "source_text": "Find the time between when a vehicle is first advertised on the site to when the vehicle was sold",
      "ref": "Days to Sell = ceil( (sale_date - first_publish) in days )"
    },
    {
      "id": "5_D2_join_on_user_id",
      "kind": "Multi-table alignment",
      "node_id": "join_ads_users",
      "op": "join",
      "source_text": "Join the data sets together",
      "ref": "Join on user_id"
    },
    {
      "id": "6_O2_join_type_left",
      "kind": "Row-level concept",
      "node_id": "join_ads_users",
      "op": "join",
      "source_text": "Join the data sets together",
      "ref": "how='left'"
    },
    {
      "id": "7_O2_keep_only_dealership_listings",
      "kind": "Row-level concept",
      "node_id": "filter_type",
      "op": "filter",
      "source_text": "Dealerships report the average number of days that a vehicle is on the platform",
      "ref": "Only keep rows where seller_type = 'Dealership'"
    },
    {
      "id": "8_O3_first_post_ties_keep_all",
      "kind": "Operation boundary",
      "node_id": "dedup_first",
      "op": "dedup",
      "intent": "When multiple ads have the same first_published timestamp, keep all of them.",
      "ref": "No dedup on same publish time"
    },
    {
      "id": "9_O2_users_token_delimiter_commas",
      "kind": "Single-table reference",
      "node_id": "parse_users",
      "op": "project",
      "source_text": "Split the seller_location field",
      "ref": "Split on comma"
    }
  ]
}